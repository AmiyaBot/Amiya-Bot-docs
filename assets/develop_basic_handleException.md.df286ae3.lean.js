import{_ as a,o as n,c as o,S as l}from"./chunks/framework.2ada2e54.js";const i=JSON.parse('{"title":"异常监听","description":"","frontmatter":{},"headers":[],"relativePath":"develop/basic/handleException.md","filePath":"develop/basic/handleException.md","lastUpdated":1752828192000}'),p={name:"develop/basic/handleException.md"};function e(t,s,c,r,y,D){return n(),o("div",null,s[0]||(s[0]=[l(`<h1 id="异常监听" tabindex="-1">异常监听 <a class="header-anchor" href="#异常监听" aria-label="Permalink to &quot;异常监听&quot;">​</a></h1><p>AmiyaBot 内置了全局的用户层面异常捕获让程序不会轻易崩溃。如果你希望获取这些异常，可以通过注册异常处理器来获得它们。在执行消息响应或在消息响应筛选过程产生异常时，会执行这些注册的异常处理函数。</p><p>异常处理函数接受三个参数，分别是 <strong>异常类型实例</strong> <code>Exception</code>、<strong>适配器实例</strong> <code>BotAdapterProtocol</code>、<strong>产生异常的数据</strong> （<code>Message</code> 或 <code>Event</code>）</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> amiyabot </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> BotAdapterProtocol</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on_exception</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">_</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">err</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Exception</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#BABED8;font-style:italic;">instance</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> BotAdapterProtocol</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#BABED8;font-style:italic;">data</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Union</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">Message</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> Event</span><span style="color:#89DDFF;">]):</span></span>
<span class="line"><span style="color:#BABED8;">    ...</span></span></code></pre></div><h2 id="指定异常类型" tabindex="-1">指定异常类型 <a class="header-anchor" href="#指定异常类型" aria-label="Permalink to &quot;指定异常类型&quot;">​</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on_exception</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">KeyError</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">_</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">err</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Exception</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#BABED8;font-style:italic;">instance</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> BotAdapterProtocol</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#BABED8;font-style:italic;">data</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Union</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">Message</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> Event</span><span style="color:#89DDFF;">]):</span></span>
<span class="line"><span style="color:#BABED8;">    ...</span></span></code></pre></div><h2 id="指定多种异常类型" tabindex="-1">指定多种异常类型 <a class="header-anchor" href="#指定多种异常类型" aria-label="Permalink to &quot;指定多种异常类型&quot;">​</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on_exception</span><span style="color:#89DDFF;">([</span><span style="color:#FFCB6B;">OSError</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#FFCB6B;">IndexError</span><span style="color:#89DDFF;">])</span></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">_</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">err</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Exception</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#BABED8;font-style:italic;">instance</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> BotAdapterProtocol</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#BABED8;font-style:italic;">data</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Union</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">Message</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> Event</span><span style="color:#89DDFF;">]):</span></span>
<span class="line"><span style="color:#BABED8;">    ...</span></span></code></pre></div>`,8)]))}const B=a(p,[["render",e]]);export{i as __pageData,B as default};
