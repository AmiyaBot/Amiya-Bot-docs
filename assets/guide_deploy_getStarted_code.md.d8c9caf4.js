import{_ as a,o as n,c as l,S as p}from"./chunks/framework.e7d5bd7a.js";const B=JSON.parse('{"title":"通过代码部署","description":"","frontmatter":{},"headers":[],"relativePath":"guide/deploy/getStarted/code.md","filePath":"guide/deploy/getStarted/code.md","lastUpdated":1762506263000}'),o={name:"guide/deploy/getStarted/code.md"};function e(t,s,c,r,i,y){return n(),l("div",null,[...s[0]||(s[0]=[p(`<h1 id="通过代码部署" tabindex="-1">通过代码部署 <a class="header-anchor" href="#通过代码部署" aria-label="Permalink to &quot;通过代码部署&quot;">​</a></h1><p>请根据操作系统按顺序执行以下命令。</p><div class="warning custom-block"><p class="custom-block-title">注意<br></p><p>推荐使用 Python 3.8 ~ 3.9 运行本项目代码，并参照可执行文件的系统支持选择部署的操作系统。</p></div><ol><li><a href="https://github.com/AmiyaBot/Amiya-Bot" target="_blank" rel="noreferrer">克隆仓库</a></li></ol><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">git</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">clone</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--depth</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">https://github.com/AmiyaBot/Amiya-Bot.git</span></span>
<span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">Amiya-Bot</span></span></code></pre></div><ol start="2"><li>使用 <a href="https://virtualenv.pypa.io/en/latest/" target="_blank" rel="noreferrer">virtualenv</a> 创建虚拟环境（非必须，或根据个人习惯选择虚拟环境）</li></ol><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Windows</span></span>
<span class="line"><span style="color:#FFCB6B;">python</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">venv</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">venv</span></span>
<span class="line"><span style="color:#FFCB6B;">call</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">venv/Scripts/activate.bat</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Linux or MacOS</span></span>
<span class="line"><span style="color:#FFCB6B;">python</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">venv</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">venv</span></span>
<span class="line"><span style="color:#82AAFF;">source</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">venv/bin/activate</span></span></code></pre></div><ol start="3"><li>安装依赖</li></ol><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">pip</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">install</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">-r</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">requirements.txt</span></span></code></pre></div><ol start="4"><li>安装浏览器内核</li></ol><p>默认为 Chromium</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Windows or MacOS</span></span>
<span class="line"><span style="color:#FFCB6B;">playwright</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">install</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">chromium</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Linux</span></span>
<span class="line"><span style="color:#FFCB6B;">playwright</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">install</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--with-deps</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">chromium</span></span></code></pre></div><p>部分系统由于版本过低（如 Windows Server 2012），可能不支持 chromium 内核。推荐修改为火狐（firefox）内核启动。</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># Windows or MacOS</span></span>
<span class="line"><span style="color:#FFCB6B;">playwright</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">install</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">firefox</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Linux</span></span>
<span class="line"><span style="color:#FFCB6B;">playwright</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">install</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">--with-deps</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">firefox</span></span></code></pre></div><details class="details custom-block"><summary>使用火狐内核需要修改入口程序 <code>amiya.py</code>，点击查看代码</summary><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight has-highlighted-lines"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> ...</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> amiyabot </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> BrowserLaunchConfig  </span><span style="color:#676E95;font-style:italic;"># 导入浏览器启动配置类</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#676E95;font-style:italic;"># 创建新启动类</span></span>
<span class="line highlighted"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Launcher</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">BrowserLaunchConfig</span><span style="color:#89DDFF;">):</span></span>
<span class="line highlighted"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">__init__</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">):</span></span>
<span class="line highlighted"><span style="color:#BABED8;">        </span><span style="color:#FFCB6B;">super</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">__init__</span><span style="color:#89DDFF;">()</span></span>
<span class="line highlighted"><wbr></span>
<span class="line highlighted"><span style="color:#BABED8;">        self</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">browser_type</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">firefox</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">  </span><span style="color:#676E95;font-style:italic;"># 设定浏览器属性</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">run_amiya</span><span style="color:#89DDFF;">(*</span><span style="color:#BABED8;font-style:italic;">tasks</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Coroutine</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">    ...</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> __name__ </span><span style="color:#89DDFF;">==</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">__main__</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#82AAFF;">run_amiya</span><span style="color:#89DDFF;">(</span></span>
<span class="line highlighted"><span style="color:#82AAFF;">        bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">start</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">launch_browser</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">Launcher</span><span style="color:#89DDFF;">()),</span><span style="color:#82AAFF;">  </span><span style="color:#676E95;font-style:italic;"># 更改为使用新启动类启动浏览器</span></span>
<span class="line"><span style="color:#82AAFF;">        app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">serve</span><span style="color:#89DDFF;">(),</span></span>
<span class="line"><span style="color:#82AAFF;">        load_plugins</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">)</span></span></code></pre></div></details><ol start="5"><li>运行代码</li></ol><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">python</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">amiya.py</span></span></code></pre></div><p>日志显示同可执行文件部署，成功后可以进入下一节。</p>`,19)])])}const F=a(o,[["render",e]]);export{B as __pageData,F as default};
