import{_ as a,o as n,c as l,S as o}from"./chunks/framework.e7d5bd7a.js";const i=JSON.parse('{"title":"发送主动消息","description":"","frontmatter":{},"headers":[],"relativePath":"develop/basic/sendActiveMessage.md","filePath":"develop/basic/sendActiveMessage.md","lastUpdated":1762506263000}'),p={name:"develop/basic/sendActiveMessage.md"};function e(t,s,c,r,F,D){return n(),l("div",null,[...s[0]||(s[0]=[o(`<h1 id="发送主动消息" tabindex="-1">发送主动消息 <a class="header-anchor" href="#发送主动消息" aria-label="Permalink to &quot;发送主动消息&quot;">​</a></h1><div class="danger custom-block"><p class="custom-block-title">主动消息限制<br></p><p>主动消息需要频道设置允许机器人推送，发送消息也存在数量限制。<br> 详见官方文档 <a href="https://bot.q.qq.com/wiki/#_9-%E5%8F%91%E5%B8%83%E8%AE%BE%E7%BD%AE" target="_blank" rel="noreferrer">接入流程-语料配置-消息类型</a></p></div><h2 id="amiyabot-send-message" tabindex="-1">AmiyaBot.send_message() <a class="header-anchor" href="#amiyabot-send-message" aria-label="Permalink to &quot;AmiyaBot.send_message()&quot;">​</a></h2><p>send_message 是发送主动消息的方法，它的第一个参数 chain 需要传入一个 Chain 对象。可以通过实例化一个无 Message 的 Chain 得到。</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">message </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">Chain</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">text</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><table><thead><tr><th>参数名</th><th>类型</th><th>释义</th><th>默认值</th></tr></thead><tbody><tr><td>chain</td><td>Chain</td><td>Chain 对象</td><td></td></tr><tr><td>user_id</td><td>str</td><td>用户ID</td><td></td></tr><tr><td>channel_id</td><td>str</td><td>子频道ID</td><td></td></tr><tr><td>direct_src_guild_id</td><td>str</td><td>来源频道ID</td><td></td></tr></tbody></table><h2 id="发送一条主动子频道消息" tabindex="-1">发送一条主动子频道消息 <a class="header-anchor" href="#发送一条主动子频道消息" aria-label="Permalink to &quot;发送一条主动子频道消息&quot;">​</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">bot </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">AmiyaBot</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">message </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">Chain</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">text</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send_message</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">message</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">channel_id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">******</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><h2 id="发送一条主动私信-beta" tabindex="-1">发送一条主动私信 <span class="err-tag">Beta</span> <a class="header-anchor" href="#发送一条主动私信-beta" aria-label="Permalink to &quot;发送一条主动私信 &lt;span class=&quot;err-tag&quot;&gt;Beta&lt;/span&gt;&quot;">​</a></h2><p>传入参数 <code>user_id</code>（用户ID）和 <code>direct_src_guild_id</code>（来源频道ID），send_message 将会发送主动私信消息。</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">bot </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">AmiyaBot</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">message </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">Chain</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">text</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send_message</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">message</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">                       </span><span style="color:#BABED8;font-style:italic;">user_id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*******</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">                       </span><span style="color:#BABED8;font-style:italic;">direct_src_guild_id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*******</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><h2 id="在多账号实例里使用-send-message" tabindex="-1">在多账号实例里使用 send_message <a class="header-anchor" href="#在多账号实例里使用-send-message" aria-label="Permalink to &quot;在多账号实例里使用 send_message&quot;">​</a></h2><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">bot </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MultipleAccounts</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">[</span></span>
<span class="line"><span style="color:#82AAFF;">        AmiyaBot</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">appid</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">111111</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> ...</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#82AAFF;">        AmiyaBot</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">appid</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">222222</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> ...</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> bot</span><span style="color:#89DDFF;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">222222</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">].</span><span style="color:#82AAFF;">send_message</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">)</span></span></code></pre></div><h2 id="在事件响应里使用-send-message" tabindex="-1">在事件响应里使用 send_message <a class="header-anchor" href="#在事件响应里使用-send-message" aria-label="Permalink to &quot;在事件响应里使用 send_message&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">提示<br></p><p>事件响应的方法通常可以返回触发了该事件的实例。</p></div><h3 id="事件监听" tabindex="-1">事件监听 <a class="header-anchor" href="#事件监听" aria-label="Permalink to &quot;事件监听&quot;">​</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on_event</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">MESSAGE_DELETE</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">_</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">event</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Event</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">instance</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> BotAdapterProtocol</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> instance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send_message</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">)</span></span></code></pre></div><h3 id="异常监听" tabindex="-1">异常监听 <a class="header-anchor" href="#异常监听" aria-label="Permalink to &quot;异常监听&quot;">​</a></h3><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">bot</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on_exception</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">_</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">err</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">Exception</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#BABED8;font-style:italic;">instance</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> BotAdapterProtocol</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">            </span><span style="color:#BABED8;font-style:italic;">data</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Union</span><span style="color:#89DDFF;">[</span><span style="color:#BABED8;">Message</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> Event</span><span style="color:#89DDFF;">]):</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> instance</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send_message</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">...</span><span style="color:#89DDFF;">)</span></span></code></pre></div>`,19)])])}const d=a(p,[["render",e]]);export{i as __pageData,d as default};
