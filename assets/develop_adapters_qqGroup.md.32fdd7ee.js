import{_ as a,o as n,c as l,S as p}from"./chunks/framework.e7d5bd7a.js";const i=JSON.parse('{"title":"QQ 群机器人 Beta","description":"","frontmatter":{},"headers":[],"relativePath":"develop/adapters/qqGroup.md","filePath":"develop/adapters/qqGroup.md","lastUpdated":1762506263000}'),o={name:"develop/adapters/qqGroup.md"};function t(e,s,c,r,F,y){return n(),l("div",null,[...s[0]||(s[0]=[p(`<h1 id="qq-群机器人-beta" tabindex="-1">QQ 群机器人 <span class="beta-tag">Beta</span> <a class="header-anchor" href="#qq-群机器人-beta" aria-label="Permalink to &quot;QQ 群机器人 &lt;span class=&quot;beta-tag&quot;&gt;Beta&lt;/span&gt;&quot;">​</a></h1><p>在 <a href="https://bot.q.qq.com/wiki/#_2-%E4%BC%81%E4%B8%9A%E4%B8%BB%E4%BD%93%E5%85%A5%E9%A9%BB" target="_blank" rel="noreferrer">QQ 开放平台</a> 完成主体入驻，即可创建可在 QQ 群聊里使用的 QQ 群机器人。</p><h2 id="在公网下使用" tabindex="-1">在公网下使用 <a class="header-anchor" href="#在公网下使用" aria-label="Permalink to &quot;在公网下使用&quot;">​</a></h2><p>QQ 群聊适配器默认在本地启动资源服务让腾讯服务器能够访问媒体资源，需要在公网下使用。如果无法在公网下部署，请参考<a href="#自定义资源服务">自定义资源服务</a>。</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> amiyabot</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">adapters</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">tencent</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">qqGroup </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> qq_group</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">client_secret </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">******</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># 密钥</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">bot </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">AmiyaBot</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">appid</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">******</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">token</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">******</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">adapter</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">qq_group</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">client_secret</span><span style="color:#89DDFF;">))</span></span></code></pre></div><p><code>qq_group</code> 参数</p><table><thead><tr><th>参数名</th><th>类型</th><th>释义</th><th>默认值</th></tr></thead><tbody><tr><td>client_secret</td><td>str</td><td>机器人密钥</td><td></td></tr><tr><td>default_chain_builder</td><td></td><td>默认消息构建器</td><td>None</td></tr><tr><td>default_chain_builder_options</td><td></td><td>默认消息构建器参数</td><td>QQGroupChainBuilderOptions()</td></tr><tr><td>shard_index</td><td>int</td><td>分片下标，从 0 开始</td><td>0</td></tr><tr><td>shards</td><td>int</td><td>分片总数</td><td>1</td></tr></tbody></table><ul><li>在机器人启动时，资源服务也会一同启动。</li><li>默认的资源服务是端口单例的，实例化多个 QQ 群聊适配器 AmiyaBot 或使用 <a href="/develop/basic/multipleAccounts.html">多账号</a> 时，同一个端口的资源服务会相互共享。</li></ul><h2 id="事件分片" tabindex="-1">事件分片 <a class="header-anchor" href="#事件分片" aria-label="Permalink to &quot;事件分片&quot;">​</a></h2><p>考虑到开发者事件接收时可以实现负载均衡，QQ 提供了分片逻辑，事件通知会落在不同的分片上，可参考官方文档 <a href="https://bot.q.qq.com/wiki/develop/api-v2/dev-prepare/interface-framework/event-emit.html#%E5%88%86%E7%89%87%E8%BF%9E%E6%8E%A5loadbalance" target="_blank" rel="noreferrer">分片连接LoadBalance</a> 了解分片机制。</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">bot1 </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">AmiyaBot</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">appid</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">...</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">token</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">...</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">adapter</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">qq_group</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">client_secret</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">...</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">shard_index</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">shards</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">bot2 </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">AmiyaBot</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">appid</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">...</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">token</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">...</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">adapter</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">qq_group</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">client_secret</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">...</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">shard_index</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">shards</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span></code></pre></div><div class="danger custom-block"><p class="custom-block-title">注意<br></p><p>每个分片的启动应当<strong>按顺序缓慢进行</strong>，切勿同时启动，以免 gateway 返回的信息一致造成连接失败。</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 仅作示意，实际上每个分片应当是独立的服务。</span></span>
<span class="line"><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">start</span><span style="color:#89DDFF;">():</span></span>
<span class="line"><span style="color:#BABED8;">    asyncio</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">create_task</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">bot1</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">start</span><span style="color:#89DDFF;">())</span></span>
<span class="line"><span style="color:#BABED8;">    time</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sleep</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    asyncio</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">create_task</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">bot2</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">start</span><span style="color:#89DDFF;">())</span></span></code></pre></div></div><h3 id="修改资源服务配置" tabindex="-1">修改资源服务配置 <a class="header-anchor" href="#修改资源服务配置" aria-label="Permalink to &quot;修改资源服务配置&quot;">​</a></h3><p>引入 <code>QQGroupChainBuilderOptions</code> 修改默认的资源服务配置。</p><table><thead><tr><th>参数名</th><th>类型</th><th>释义</th><th>默认值</th></tr></thead><tbody><tr><td>host</td><td>str</td><td>资源服务监听地址</td><td>0.0.0.0</td></tr><tr><td>port</td><td>int</td><td>资源服务监听端口</td><td>8086</td></tr><tr><td>resource_path</td><td>str</td><td>临时文件存放目录</td><td>./resource</td></tr><tr><td>http_server_options</td><td>dict</td><td><a href="/develop/tools/httpSupport.html">HttpServer **kwargs</a></td><td></td></tr></tbody></table><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> amiyabot</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">adapters</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">tencent</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">qqGroup </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> qq_group</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> amiyabot</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">adapters</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">tencent</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">qqGroup</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">builder </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> QQGroupChainBuilderOptions</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">bot </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">AmiyaBot</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">appid</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">******</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">token</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">******</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">adapter</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">qq_group</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">client_secret</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">******</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">default_chain_builder_options</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">QQGroupChainBuilderOptions</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0.0.0.0</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">            </span><span style="color:#F78C6C;">8086</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./resource</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span></code></pre></div><h2 id="自定义资源服务" tabindex="-1">自定义资源服务 <a class="header-anchor" href="#自定义资源服务" aria-label="Permalink to &quot;自定义资源服务&quot;">​</a></h2><p>非公网部署下的资源服务难题解决途径非常多，这里列举两个比较常见的解决办法。</p><h3 id="使用内网穿透" tabindex="-1">使用内网穿透 <a class="header-anchor" href="#使用内网穿透" aria-label="Permalink to &quot;使用内网穿透&quot;">​</a></h3><p>使用一些内网穿透工具代理本地地址 <a href="http://127.0.0.1:8086" target="_blank" rel="noreferrer">http://127.0.0.1:8086</a>（视配置而定）后，通常会得到一个新的地址。继承 <code>QQGroupChainBuilder</code> 并覆盖 <strong>domain</strong> 方法，即可使用内网穿透让腾讯服务器访问资源。</p><p>示例：</p><blockquote><p><strong>http://<span style="color:red;">3913rc56vl17.vicp.fun:40229</span>/resource</strong></p></blockquote><p>红色高亮部分即为内网穿透地址，<code>/resource</code> 为固定的路由值。</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> amiyabot</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">adapters</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">tencent</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">qqGroup </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> qq_group</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> QQGroupChainBuilder</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> QQGroupChainBuilderOptions</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">PenetrationChainBuilder</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">QQGroupChainBuilder</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">@</span><span style="color:#FFCB6B;">property</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">domain</span><span style="color:#89DDFF;">(</span><span style="color:#F07178;font-style:italic;">self</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://3913rc56vl17.vicp.fun:40229/resource</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">bot </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">AmiyaBot</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">    ...</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">adapter</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">qq_group</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">        ...</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">default_chain_builder</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">PenetrationChainBuilder</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">            QQGroupChainBuilderOptions</span><span style="color:#89DDFF;">(),</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span></code></pre></div><h3 id="继承-chainbuilder-并实现相关方法使用第三方托管服务。" tabindex="-1">继承 ChainBuilder 并实现相关方法使用第三方托管服务。 <a class="header-anchor" href="#继承-chainbuilder-并实现相关方法使用第三方托管服务。" aria-label="Permalink to &quot;继承 ChainBuilder 并实现相关方法使用第三方托管服务。&quot;">​</a></h3><p>多数情况下我们推荐使用第三方托管服务来搭建资源服务，如 <a href="https://www.baidu.com/s?wd=%E8%85%BE%E8%AE%AF%E4%BA%91COS" target="_blank" rel="noreferrer">腾讯云COS</a> 或 <a href="https://www.baidu.com/s?wd=%E9%98%BF%E9%87%8C%E4%BA%91OSS" target="_blank" rel="noreferrer">阿里云OSS</a> 等。通过自定义默认的 <code>ChainBuilder</code> ，来实现上传文件到托管服务以及返回生成的 url。</p><p>可参考 <a href="/develop/advanced/chainBuilder.html">进阶指南 - 介入媒体消息的构建过程</a></p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> typing </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> Union</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> graiax </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> silkcoder</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> amiyabot </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> ChainBuilder</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">ThirdPartyChainBuilder</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">ChainBuilder</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">@</span><span style="color:#FFCB6B;">classmethod</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">get_image</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">cls</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Union</span><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">bytes</span><span style="color:#89DDFF;">])</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#BABED8;"> Union</span><span style="color:#89DDFF;">[</span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">bytes</span><span style="color:#89DDFF;">]:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#676E95;font-style:italic;"># 上传图片到第三方托管服务</span></span>
<span class="line"><span style="color:#BABED8;">        ...</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#BABED8;"> url </span><span style="color:#676E95;font-style:italic;"># 返回访问资源的 URL</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">@</span><span style="color:#FFCB6B;">classmethod</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">get_voice</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">cls</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">voice_file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#676E95;font-style:italic;"># 上传语音文件到第三方托管服务，语音文件必须是 silk 格式</span></span>
<span class="line"><span style="color:#BABED8;">        voice</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">bytes</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> silkcoder</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">async_encode</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">voice_file</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">ios_adaptive</span><span style="color:#89DDFF;">=True)</span></span>
<span class="line"><span style="color:#BABED8;">        ...</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#BABED8;"> url </span><span style="color:#676E95;font-style:italic;"># 返回访问资源的 URL</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">@</span><span style="color:#FFCB6B;">classmethod</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">get_video</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">cls</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">video_file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">str</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#676E95;font-style:italic;"># 上传视频文件到第三方托管服务</span></span>
<span class="line"><span style="color:#BABED8;">        ...</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#BABED8;"> url </span><span style="color:#676E95;font-style:italic;"># 返回访问资源的 URL</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">bot </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">AmiyaBot</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">    ...</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#BABED8;font-style:italic;">adapter</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">qq_group</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">        ...</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">default_chain_builder</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">ThirdPartyChainBuilder</span><span style="color:#89DDFF;">(),</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#89DDFF;">)</span></span></code></pre></div>`,28)])])}const B=a(o,[["render",t]]);export{i as __pageData,B as default};
